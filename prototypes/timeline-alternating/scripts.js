(()=>{const saved=localStorage.getItem('palette');const def='eoy-hyperviolet';document.documentElement.setAttribute('data-palette',saved||def);if(!saved)localStorage.setItem('palette',def);const buttons=[...document.querySelectorAll('[data-palette]')];buttons.forEach(btn=>btn.addEventListener('click',()=>{const p=btn.getAttribute('data-palette');document.documentElement.setAttribute('data-palette',p);localStorage.setItem('palette',p)}));})();
(()=>{const reduce=window.matchMedia('(prefers-reduced-motion: reduce)').matches;const items=[...document.querySelectorAll('.alt-item[data-animate]')];if(reduce){items.forEach(el=>el.classList.add('visible'));return}const observer=new IntersectionObserver((entries)=>{entries.forEach((e)=>{if(e.isIntersecting){e.target.classList.add('visible')}})},{threshold:.2});items.forEach(el=>observer.observe(el));let needs=false;let width=window.innerWidth;const apply=()=>{needs=false;if(width<=960)return;const h=window.innerHeight;const c=h/2;for(const el of items){if(!el.classList.contains('visible'))continue;const r=el.getBoundingClientRect();const y=r.top+r.height/2;const d=y-c;const ty=Math.max(-14,Math.min(14,d/c*14));const s=1+Math.max(-.02,Math.min(.02,-Math.abs(d)/h*.04));el.style.setProperty('--ty',ty.toFixed(2)+'px');el.style.setProperty('--s',s.toFixed(3))}};const onScroll=()=>{if(needs)return;needs=true;requestAnimationFrame(apply)};window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',()=>{width=window.innerWidth;onScroll()},{passive:true});apply()})();
(()=>{const btn=document.querySelector('[data-toggle="details"]');const panel=document.getElementById('zensorium-details');if(!btn||!panel)return;btn.addEventListener('click',()=>{const now=btn.getAttribute('aria-expanded')==='true';btn.setAttribute('aria-expanded',String(!now));panel.classList.toggle('open',!now);if(!now)panel.focus({preventScroll:true})})})();

/* background rendering removed */
